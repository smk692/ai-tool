# RAG Indexer 설정 파일 예제
# 이 파일을 config.yaml로 복사하여 사용하세요.
# 환경 변수가 설정된 경우 환경 변수 값이 우선 적용됩니다.

# =============================================================================
# 애플리케이션 기본 설정
# =============================================================================
app:
  # 애플리케이션 이름
  name: "rag-indexer"

  # 디버그 모드 (true/false)
  # 환경 변수: DEBUG
  debug: false

  # 로그 레벨 (DEBUG, INFO, WARNING, ERROR, CRITICAL)
  # 환경 변수: LOG_LEVEL
  log_level: "INFO"

  # 데이터 저장 디렉토리 (sources.json, documents.json, sync_history.json)
  # 환경 변수: DATA_DIR
  data_dir: "./data"

# =============================================================================
# Qdrant 벡터 데이터베이스 설정
# =============================================================================
qdrant:
  # Qdrant 서버 호스트
  # 환경 변수: QDRANT_HOST
  host: "localhost"

  # Qdrant 서버 포트
  # 환경 변수: QDRANT_PORT
  port: 6333

  # 컬렉션 이름
  # 환경 변수: QDRANT_COLLECTION
  collection_name: "rag_documents"

  # Qdrant Cloud 사용 시 API 키 (선택적)
  # 환경 변수: QDRANT_API_KEY
  api_key: null

# =============================================================================
# Notion API 설정
# =============================================================================
notion:
  # Notion Integration API 키 (필수)
  # 환경 변수: NOTION_API_KEY
  # https://www.notion.so/my-integrations 에서 생성
  api_key: ""

  # API 호출 간 대기 시간 (초) - Rate Limit 방지
  # 환경 변수: NOTION_RATE_LIMIT_DELAY
  rate_limit_delay: 0.5

  # API 호출 실패 시 최대 재시도 횟수
  # 환경 변수: NOTION_MAX_RETRIES
  max_retries: 3

# =============================================================================
# 임베딩 모델 설정
# =============================================================================
embedding:
  # HuggingFace 모델 이름
  # 환경 변수: EMBEDDING_MODEL
  # 권장: intfloat/multilingual-e5-large-instruct (한국어 지원)
  model_name: "intfloat/multilingual-e5-large-instruct"

  # 임베딩 벡터 차원 (모델에 따라 결정)
  # 환경 변수: EMBEDDING_DIMENSION
  dimension: 1024

  # 배치 처리 크기 (메모리에 따라 조정)
  # 환경 변수: EMBEDDING_BATCH_SIZE
  batch_size: 32

# =============================================================================
# 텍스트 청킹 설정
# =============================================================================
chunking:
  # 청크 크기 (문자 수)
  # 환경 변수: CHUNK_SIZE
  chunk_size: 1000

  # 청크 간 오버랩 (문자 수) - 컨텍스트 보존
  # 환경 변수: CHUNK_OVERLAP
  chunk_overlap: 200

# =============================================================================
# 계층적 청킹 설정 (Phase 1.3)
# =============================================================================
hierarchical_chunking:
  # 계층적 청킹 활성화 여부
  # 환경 변수: HIERARCHICAL_CHUNKING_ENABLED
  enabled: false

  # 부모 청크 크기 (포괄적 컨텍스트)
  # 환경 변수: PARENT_CHUNK_SIZE
  parent_chunk_size: 4000

  # 부모 청크 오버랩
  # 환경 변수: PARENT_CHUNK_OVERLAP
  parent_chunk_overlap: 400

  # 자식 청크 크기 (정밀 검색용)
  # 환경 변수: CHILD_CHUNK_SIZE
  child_chunk_size: 800

  # 자식 청크 오버랩
  # 환경 변수: CHILD_CHUNK_OVERLAP
  child_chunk_overlap: 100

# =============================================================================
# 스케줄러 설정 (자동 동기화)
# =============================================================================
scheduler:
  # 스케줄러 활성화 여부
  # 환경 변수: SCHEDULER_ENABLED
  enabled: false

  # Cron 표현식 (기본: 매시간)
  # 환경 변수: SCHEDULER_CRON
  # 예시:
  #   "0 * * * *"    - 매시간 정각
  #   "*/30 * * * *" - 30분마다
  #   "0 0 * * *"    - 매일 자정
  #   "0 9 * * 1-5"  - 평일 오전 9시
  cron_expression: "0 * * * *"

  # 타임존
  # 환경 변수: SCHEDULER_TIMEZONE
  timezone: "Asia/Seoul"

# =============================================================================
# AI 메타데이터 추출 설정 (Phase 1.2)
# =============================================================================
ai:
  # AI 메타데이터 추출 활성화 여부
  # 환경 변수: AI_EXTRACTION_ENABLED
  enabled: false

  # Anthropic Claude API 키 (AI 추출 사용 시 필수)
  # 환경 변수: ANTHROPIC_API_KEY
  api_key: ""

  # 사용할 Claude 모델
  # 환경 변수: AI_MODEL
  model: "claude-3-haiku-20240307"

  # 최대 토큰 수
  # 환경 변수: AI_MAX_TOKENS
  max_tokens: 1024

  # API 요청 타임아웃 (초)
  # 환경 변수: AI_TIMEOUT
  timeout: 30.0

  # 추출 결과 캐싱 여부
  # 환경 변수: AI_CACHE_ENABLED
  cache_enabled: true

# =============================================================================
# 동기화 설정
# =============================================================================
sync:
  # 동기화 시 변경된 문서만 처리 (해시 기반 변경 감지)
  # 환경 변수: SYNC_INCREMENTAL
  incremental: true

  # 문서당 최대 재시도 횟수
  # 환경 변수: SYNC_MAX_RETRIES
  max_retries: 3

  # 오류 발생 시 나머지 문서 계속 처리
  # 환경 변수: SYNC_CONTINUE_ON_ERROR
  continue_on_error: true

# =============================================================================
# 로깅 설정
# =============================================================================
logging:
  # JSON 형식 로그 출력 (프로덕션 환경 권장)
  # 환경 변수: LOG_JSON_FORMAT
  json_format: false

  # 로그 파일 경로 (null이면 stdout만 출력)
  # 환경 변수: LOG_FILE
  file: null

  # 로그 파일 최대 크기 (MB)
  # 환경 변수: LOG_MAX_SIZE_MB
  max_size_mb: 100

  # 보관할 로그 파일 개수
  # 환경 변수: LOG_BACKUP_COUNT
  backup_count: 5
