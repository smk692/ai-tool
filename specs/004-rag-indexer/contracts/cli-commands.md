# CLI ëª…ë ¹ì–´ ìŠ¤í™: RAG Document Indexer

**ì‘ì„±ì¼**: 2025-12-05
**ë²„ì „**: 1.0

## ê°œìš”

`rag-indexer` CLIëŠ” RAG ë¬¸ì„œ ì¸ë±ì‹± íŒŒì´í”„ë¼ì¸ì„ ê´€ë¦¬í•˜ëŠ” ëª…ë ¹ì¤„ ë„êµ¬ì…ë‹ˆë‹¤.

---

## ì„¤ì¹˜

```bash
# ê°œë°œ ëª¨ë“œ ì„¤ì¹˜
cd rag-indexer
pip install -e ".[dev]"

# ëª…ë ¹ì–´ í™•ì¸
rag-indexer --help
```

---

## ëª…ë ¹ì–´ êµ¬ì¡°

```
rag-indexer <command> [options]

Commands:
  source    ì†ŒìŠ¤ ê´€ë¦¬ (ì¶”ê°€/ì‚­ì œ/ëª©ë¡)
  sync      ë™ê¸°í™” ì‹¤í–‰
  status    ìƒíƒœ ì¡°íšŒ
  scheduler ìŠ¤ì¼€ì¤„ëŸ¬ ê´€ë¦¬
```

---

## source - ì†ŒìŠ¤ ê´€ë¦¬

### source add

ìƒˆ ë°ì´í„° ì†ŒìŠ¤ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.

```bash
# Notion í˜ì´ì§€ ì†ŒìŠ¤ ì¶”ê°€
rag-indexer source add \
  --name "íŒ€ ìœ„í‚¤" \
  --type notion \
  --page-id abc123def456 \
  --page-id xyz789uvw012

# Notion ë°ì´í„°ë² ì´ìŠ¤ ì†ŒìŠ¤ ì¶”ê°€
rag-indexer source add \
  --name "ì—…ë¬´ ë§¤ë‰´ì–¼" \
  --type notion \
  --database-id db123456

# Swagger ì†ŒìŠ¤ ì¶”ê°€
rag-indexer source add \
  --name "Backend API" \
  --type swagger \
  --url "https://api.example.com/swagger.json"
```

**ì˜µì…˜**:
| ì˜µì…˜ | í•„ìˆ˜ | ì„¤ëª… |
|------|------|------|
| `--name` | âœ… | ì†ŒìŠ¤ ì´ë¦„ (ê³ ìœ í•´ì•¼ í•¨) |
| `--type` | âœ… | ì†ŒìŠ¤ íƒ€ì…: `notion`, `swagger` |
| `--page-id` | â–³ | Notion í˜ì´ì§€ ID (ë³µìˆ˜ ì§€ì • ê°€ëŠ¥) |
| `--database-id` | â–³ | Notion ë°ì´í„°ë² ì´ìŠ¤ ID (ë³µìˆ˜ ì§€ì • ê°€ëŠ¥) |
| `--url` | â–³ | Swagger JSON URL |
| `--no-children` | | Notion í•˜ìœ„ í˜ì´ì§€ ì œì™¸ |

**ì¶œë ¥ ì˜ˆì‹œ**:
```
âœ… ì†ŒìŠ¤ ë“±ë¡ ì™„ë£Œ
   ID: src_abc123
   ì´ë¦„: íŒ€ ìœ„í‚¤
   íƒ€ì…: notion
   í˜ì´ì§€: 2ê°œ
```

---

### source list

ë“±ë¡ëœ ì†ŒìŠ¤ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.

```bash
rag-indexer source list
rag-indexer source list --format json
```

**ì˜µì…˜**:
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| `--format` | ì¶œë ¥ í˜•ì‹: `table` (ê¸°ë³¸), `json` |

**ì¶œë ¥ ì˜ˆì‹œ**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì´ë¦„         â”‚ íƒ€ì…   â”‚ í•­ëª© ìˆ˜    â”‚ ë§ˆì§€ë§‰ ë™ê¸°í™”        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ íŒ€ ìœ„í‚¤      â”‚ notion â”‚ 2 pages    â”‚ 2025-12-05 06:00:00  â”‚
â”‚ Backend API  â”‚ swaggerâ”‚ 1 url      â”‚ 2025-12-04 18:30:00  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### source remove

ì†ŒìŠ¤ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤ (ì—°ê´€ ë°ì´í„° í¬í•¨).

```bash
rag-indexer source remove --name "íŒ€ ìœ„í‚¤"
rag-indexer source remove --id src_abc123 --force
```

**ì˜µì…˜**:
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| `--name` | ì‚­ì œí•  ì†ŒìŠ¤ ì´ë¦„ |
| `--id` | ì‚­ì œí•  ì†ŒìŠ¤ ID |
| `--force` | í™•ì¸ ì—†ì´ ì‚­ì œ |

**ê²½ê³ **:
```
âš ï¸ ê²½ê³ : ì´ ì‘ì—…ì€ ë‹¤ìŒì„ ì‚­ì œí•©ë‹ˆë‹¤:
   - ë¬¸ì„œ 45ê°œ
   - ë²¡í„° ì¸ë±ìŠ¤ 312ê°œ

ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ? [y/N]
```

---

## sync - ë™ê¸°í™” ì‹¤í–‰

### sync (ê¸°ë³¸)

ë“±ë¡ëœ ì†ŒìŠ¤ë¥¼ ë™ê¸°í™”í•©ë‹ˆë‹¤.

```bash
# ì „ì²´ ì†ŒìŠ¤ ë™ê¸°í™”
rag-indexer sync --all

# íŠ¹ì • ì†ŒìŠ¤ë§Œ ë™ê¸°í™”
rag-indexer sync --source "íŒ€ ìœ„í‚¤"
rag-indexer sync --source-id src_abc123

# ê°•ì œ ì „ì²´ ì¬ì¸ë±ì‹± (í•´ì‹œ ë¬´ì‹œ)
rag-indexer sync --all --force
```

**ì˜µì…˜**:
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| `--all` | ëª¨ë“  í™œì„± ì†ŒìŠ¤ ë™ê¸°í™” |
| `--source` | ì†ŒìŠ¤ ì´ë¦„ìœ¼ë¡œ ì§€ì • |
| `--source-id` | ì†ŒìŠ¤ IDë¡œ ì§€ì • |
| `--force` | ë³€ê²½ ì—¬ë¶€ ë¬´ì‹œí•˜ê³  ì „ì²´ ì¬ì¸ë±ì‹± |
| `--dry-run` | ì‹¤ì œ ì €ì¥ ì—†ì´ ì‹œë®¬ë ˆì´ì…˜ |
| `--verbose` | ìƒì„¸ ë¡œê·¸ ì¶œë ¥ |

**ì¶œë ¥ ì˜ˆì‹œ**:
```
ğŸ”„ ë™ê¸°í™” ì‹œì‘: íŒ€ ìœ„í‚¤ (notion)
   â”œâ”€ í˜ì´ì§€ ì¡°íšŒ ì¤‘... 45ê°œ ë°œê²¬
   â”œâ”€ ë³€ê²½ ê°ì§€... 3ê°œ ë³€ê²½, 42ê°œ ìŠ¤í‚µ
   â”œâ”€ ì²­í‚¹ ì¤‘... 28ê°œ ì²­í¬ ìƒì„±
   â”œâ”€ ì„ë² ë”© ìƒì„±... ì™„ë£Œ
   â””â”€ ë²¡í„°DB ì €ì¥... ì™„ë£Œ

âœ… ë™ê¸°í™” ì™„ë£Œ
   ì²˜ë¦¬: 45ê°œ | ìƒì„±: 2ê°œ | ìˆ˜ì •: 1ê°œ | ìŠ¤í‚µ: 42ê°œ
   ì†Œìš” ì‹œê°„: 1ë¶„ 23ì´ˆ
```

---

## status - ìƒíƒœ ì¡°íšŒ

### status (ê¸°ë³¸)

ì „ì²´ ì‹œìŠ¤í…œ ìƒíƒœë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

```bash
rag-indexer status
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
ğŸ“Š RAG Indexer ìƒíƒœ

ì†ŒìŠ¤ í˜„í™©:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì†ŒìŠ¤         â”‚ íƒ€ì…   â”‚ ë¬¸ì„œ ìˆ˜  â”‚ ì²­í¬ ìˆ˜ â”‚ ë§ˆì§€ë§‰ ë™ê¸°í™”        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ íŒ€ ìœ„í‚¤      â”‚ notion â”‚ 45       â”‚ 312     â”‚ 2025-12-05 06:00:00  â”‚
â”‚ Backend API  â”‚ swaggerâ”‚ 1        â”‚ 89      â”‚ 2025-12-04 18:30:00  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ë²¡í„°DB:
  - ì»¬ë ‰ì…˜: rag_documents
  - í¬ì¸íŠ¸ ìˆ˜: 401
  - ìƒíƒœ: healthy âœ…

ìŠ¤ì¼€ì¤„ëŸ¬:
  - ìƒíƒœ: running
  - ë‹¤ìŒ ì‹¤í–‰: 2025-12-06 06:00:00 (12ì‹œê°„ í›„)
```

---

### status history

ë™ê¸°í™” ì´ë ¥ì„ ì¡°íšŒí•©ë‹ˆë‹¤.

```bash
rag-indexer status history
rag-indexer status history --limit 20
rag-indexer status history --source "íŒ€ ìœ„í‚¤"
```

**ì˜µì…˜**:
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| `--limit` | í‘œì‹œí•  ì´ë ¥ ìˆ˜ (ê¸°ë³¸: 10) |
| `--source` | íŠ¹ì • ì†ŒìŠ¤ ì´ë ¥ë§Œ í‘œì‹œ |

**ì¶œë ¥ ì˜ˆì‹œ**:
```
ğŸ“œ ë™ê¸°í™” ì´ë ¥ (ìµœê·¼ 10ê±´)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì‹œê°„                 â”‚ ì†ŒìŠ¤         â”‚ ìƒíƒœ     â”‚ ë¬¸ì„œ     â”‚ ì†Œìš”    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2025-12-05 06:00:00  â”‚ ALL          â”‚ âœ… ì™„ë£Œ  â”‚ 46       â”‚ 2m 15s  â”‚
â”‚ 2025-12-04 18:30:00  â”‚ Backend API  â”‚ âœ… ì™„ë£Œ  â”‚ 1        â”‚ 45s     â”‚
â”‚ 2025-12-04 06:00:00  â”‚ ALL          â”‚ âš ï¸ ë¶€ë¶„  â”‚ 44/46    â”‚ 3m 02s  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## scheduler - ìŠ¤ì¼€ì¤„ëŸ¬ ê´€ë¦¬

### scheduler start

ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.

```bash
# ê¸°ë³¸ ìŠ¤ì¼€ì¤„ (ë§¤ì¼ ì˜¤ì „ 6ì‹œ)
rag-indexer scheduler start

# ì»¤ìŠ¤í…€ ìŠ¤ì¼€ì¤„
rag-indexer scheduler start --cron "0 6,18 * * *"  # ë§¤ì¼ 6ì‹œ, 18ì‹œ

# í¬ê·¸ë¼ìš´ë“œ ì‹¤í–‰ (ë””ë²„ê¹…ìš©)
rag-indexer scheduler start --foreground
```

**ì˜µì…˜**:
| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| `--cron` | cron í‘œí˜„ì‹ (ê¸°ë³¸: `0 6 * * *`) |
| `--foreground` | í¬ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰ |

**ì¶œë ¥ ì˜ˆì‹œ**:
```
ğŸ• ìŠ¤ì¼€ì¤„ëŸ¬ ì‹œì‘
   ìŠ¤ì¼€ì¤„: 0 6 * * * (ë§¤ì¼ 06:00)
   PID: 12345
   ë¡œê·¸: ~/.rag-indexer/scheduler.log
```

---

### scheduler stop

ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ì¤‘ì§€í•©ë‹ˆë‹¤.

```bash
rag-indexer scheduler stop
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
â¹ï¸ ìŠ¤ì¼€ì¤„ëŸ¬ ì¤‘ì§€ë¨ (PID: 12345)
```

---

### scheduler status

ìŠ¤ì¼€ì¤„ëŸ¬ ìƒíƒœë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

```bash
rag-indexer scheduler status
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
ğŸ• ìŠ¤ì¼€ì¤„ëŸ¬ ìƒíƒœ

ìƒíƒœ: running âœ…
PID: 12345
ìŠ¤ì¼€ì¤„: 0 6 * * * (ë§¤ì¼ 06:00)
ë§ˆì§€ë§‰ ì‹¤í–‰: 2025-12-05 06:00:00
ë‹¤ìŒ ì‹¤í–‰: 2025-12-06 06:00:00
```

---

## ì „ì—­ ì˜µì…˜

ëª¨ë“  ëª…ë ¹ì–´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ì˜µì…˜ì…ë‹ˆë‹¤.

| ì˜µì…˜ | ì„¤ëª… |
|------|------|
| `--config <path>` | ì„¤ì • íŒŒì¼ ê²½ë¡œ (ê¸°ë³¸: `~/.rag-indexer/config.yaml`) |
| `--log-level` | ë¡œê·¸ ë ˆë²¨: `debug`, `info`, `warning`, `error` |
| `--quiet` | ì¶œë ¥ ìµœì†Œí™” |
| `--help` | ë„ì›€ë§ í‘œì‹œ |
| `--version` | ë²„ì „ í‘œì‹œ |

---

## ì„¤ì • íŒŒì¼

`~/.rag-indexer/config.yaml`:

```yaml
# Notion API
notion:
  api_key: ${NOTION_API_KEY}  # í™˜ê²½ ë³€ìˆ˜ ì°¸ì¡°

# Qdrant
qdrant:
  host: localhost
  port: 6333
  collection: rag_documents

# ì„ë² ë”©
embedding:
  model: paraphrase-multilingual-MiniLM-L12-v2
  batch_size: 32

# ì²­í‚¹
chunking:
  chunk_size: 1000
  chunk_overlap: 200

# ìŠ¤ì¼€ì¤„ëŸ¬
scheduler:
  cron: "0 6 * * *"
  retry_attempts: 3
  retry_delay: 60  # seconds
```

---

## ì¢…ë£Œ ì½”ë“œ

| ì½”ë“œ | ì˜ë¯¸ |
|------|------|
| 0 | ì„±ê³µ |
| 1 | ì¼ë°˜ ì˜¤ë¥˜ |
| 2 | ì„¤ì • ì˜¤ë¥˜ |
| 3 | API ì—°ê²° ì˜¤ë¥˜ (Notion, Qdrant) |
| 4 | ì¸ì¦ ì˜¤ë¥˜ |
| 5 | ë¶€ë¶„ ì‹¤íŒ¨ (ì¼ë¶€ ë¬¸ì„œ ì²˜ë¦¬ ì‹¤íŒ¨) |

---

## ì‚¬ìš© ì˜ˆì‹œ

### ì´ˆê¸° ì„¤ì •

```bash
# 1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
export NOTION_API_KEY="secret_xxx"

# 2. Notion ì†ŒìŠ¤ ë“±ë¡
rag-indexer source add \
  --name "íŒ€ ë¬¸ì„œ" \
  --type notion \
  --page-id abc123

# 3. ì²« ë™ê¸°í™” ì‹¤í–‰
rag-indexer sync --all --verbose

# 4. ìŠ¤ì¼€ì¤„ëŸ¬ ì‹œì‘
rag-indexer scheduler start
```

### ì¼ìƒ ìš´ì˜

```bash
# ìƒíƒœ í™•ì¸
rag-indexer status

# íŠ¹ì • ì†ŒìŠ¤ ìˆ˜ë™ ë™ê¸°í™”
rag-indexer sync --source "íŒ€ ë¬¸ì„œ"

# ë™ê¸°í™” ì´ë ¥ í™•ì¸
rag-indexer status history --limit 5
```

### ë¬¸ì œ í•´ê²°

```bash
# ê°•ì œ ì „ì²´ ì¬ì¸ë±ì‹±
rag-indexer sync --all --force

# ë“œë¼ì´ëŸ°ìœ¼ë¡œ ì‹œë®¬ë ˆì´ì…˜
rag-indexer sync --all --dry-run --verbose

# ë””ë²„ê·¸ ëª¨ë“œ
rag-indexer sync --all --log-level debug
```
